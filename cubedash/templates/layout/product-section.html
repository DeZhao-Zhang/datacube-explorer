{% extends "layout/base.html" %}

{# If a user chooses these fields, they carry between different pages. #}
{% set product_args = {
    'product_name':selected_product.name,
    'year': year,
    'month':month,
    'day': day
} %}

{% block title %}{{ selected_product.name }}{% endblock %}

{% block header %}
    <nav>
        <ul>
            {% set navigation_bar = [
                ('overview', 'product.overview_page'),
                ('datasets', 'product.search_page'),
            ] -%}
            {% for id, page_method in navigation_bar %}
                <li{% if id == active_page %} class="active"{% endif %}>
                    <a href="{{ url_for(page_method, **product_args) }}">
                        {{ id | title }}
                    </a>
                </li>
            {% endfor %}
            <li class="plain"><a href="{{ url_for('about_page') }}">About</a></li>
        </ul>
    </nav>
    <header>
        <select name="products"
                id='select-product'
                title="Select product"
                aria-label="Select product">

            <option value="">All products</option>
            {% for product, summary in products if summary %}
                <option value="{{ product.name }}"
                        {% if product.name == selected_product.name %}selected="selected"{% endif %}>
                    {{ product.name }}: {{ product.definition.description }} ({{ summary.dataset_count }})
                </option>
            {% endfor %}
        </select>
        <select id='select-year' aria-label="Year" title="Select year">
            <option value="">All years</option>
            {% for year_opt in range(
                    selected_summary.time_range.end.year,
                    selected_summary.time_range.begin.year - 1,
                    -1
                ) %}
                <option value="{{ year_opt }}"
                        {% if (year_opt) == year %}selected='selected'{% endif %}>
                    {{ year_opt }}
                </option>
            {% endfor %}
        </select>
        <select id='select-month' aria-label="Month" title="Select month">
            <option value="">All months</option>
            {% for month_opt in range(1, 13) %}
                <option value="{{ month_opt }}"
                        {% if (month_opt) == month %}selected='selected'{% endif %}>
                    {{ month_opt | month_name }}
                </option>
            {% endfor %}
        </select>
        <select id='select-day' aria-label="Day" title="Select day">
            <option value="">All days</option>
            {% for day_opt in range(1, 31) %}
                <option value="{{ day_opt }}"
                        {% if (day_opt) == day %}selected='selected'{% endif %}>
                    {{ day_opt }}
                </option>
            {% endfor %}
        </select>
    </header>
{% endblock %}
